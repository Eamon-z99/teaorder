<view class="page-container data-v-57280228"><view class="order-type-tabs data-v-57280228"><view data-event-opts="{{[['tap',[['setOrderType',['self']]]]]}}" class="{{['data-v-57280228','order-type-tab',orderType==='self'?'active':'']}}" bindtap="__e">自取</view><view data-event-opts="{{[['tap',[['setOrderType',['delivery']]]]]}}" class="{{['data-v-57280228','order-type-tab',orderType==='delivery'?'active':'']}}" bindtap="__e">外卖</view></view><block wx:if="{{orderType==='delivery'}}"><view data-event-opts="{{[['tap',[['chooseAddress',['$event']]]]]}}" class="delivery-address-bar data-v-57280228" bindtap="__e"><block wx:if="{{defaultAddress}}"><view class="data-v-57280228"><text class="addr-main data-v-57280228">{{defaultAddress.name+" "+defaultAddress.phone}}</text><text class="addr-detail data-v-57280228">{{defaultAddress.detail+''}}<label class="addr-tag _span data-v-57280228">{{defaultAddress.tag}}</label><block wx:if="{{defaultAddress.isDefault}}"><label class="addr-default _span data-v-57280228">默认</label></block></text></view></block><block wx:else><view class="addr-empty data-v-57280228">请选择收货地址</view></block><text class="addr-arrow data-v-57280228">></text></view></block><view class="menu-container data-v-57280228"><scroll-view class="category-sidebar data-v-57280228" scroll-y="{{true}}"><block wx:for="{{categories}}" wx:for-item="category" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['selectCategory',[index]]]]]}}" class="{{['data-v-57280228','category-item',activeCategoryIndex===index?'active':'']}}" bindtap="__e">{{''+category+''}}</view></block></scroll-view><scroll-view class="menu-list data-v-57280228" scroll-y="{{true}}" scroll-into-view="{{targetScrollViewId}}" scroll-with-animation="{{true}}" scroll-into-view-options="{{({block:'start',behavior:'smooth'})}}" data-event-opts="{{[['scroll',[['handleVirtualScroll',['$event']]]]]}}" bindscroll="__e"><block wx:for="{{$root.l1}}" wx:for-item="group" wx:for-index="idx" wx:key="name"><view id="{{'c'+idx}}" class="data-v-57280228"><view class="category-title data-v-57280228">{{group.$orig.name}}</view><block wx:for="{{group.l0}}" wx:for-item="item" wx:for-index="__i0__" wx:key="id"><view data-event-opts="{{[['tap',[['goToChoose',['$0'],[[['groupedMenu','name',group.$orig.name],['visibleItems','id',item.$orig.id]]]]]]]}}" class="{{['data-v-57280228','menu-card',highlightProductId===item.$orig.id?'highlighted':'']}}" bindtap="__e"><image class="menu-img data-v-57280228" src="{{item.$orig.img||item.$orig.image_url||$oss+'logo.png'}}" mode="aspectFill" lazy-load="{{true}}"></image><view class="menu-info data-v-57280228"><text class="menu-name data-v-57280228">{{item.$orig.name}}</text><text class="menu-desc data-v-57280228">{{item.$orig.desc}}</text><text class="menu-price data-v-57280228">{{"￥"+item.$orig.price}}</text></view><block wx:if="{{item.$orig.category==='保温袋区'}}"><view class="menu-action data-v-57280228"><button data-event-opts="{{[['tap',[['changeCount',['$0',-1],[[['groupedMenu','name',group.$orig.name],['visibleItems','id',item.$orig.id]]]]]]]}}" class="num-btn data-v-57280228" catchtap="__e">-</button><text class="count data-v-57280228">{{item.m0}}</text><button data-event-opts="{{[['tap',[['changeCount',['$0',1],[[['groupedMenu','name',group.$orig.name],['visibleItems','id',item.$orig.id]]]]]]]}}" class="num-btn data-v-57280228" catchtap="__e">+</button></view></block><block wx:else><block wx:if="{{item.$orig.category!=='小料区'}}"><view class="menu-action data-v-57280228"><button data-event-opts="{{[['tap',[['changeCount',['$0',1],[[['groupedMenu','name',group.$orig.name],['visibleItems','id',item.$orig.id]]]]]]]}}" class="num-btn data-v-57280228" catchtap="__e">+</button></view></block></block></view></block></view></block><view style="height:100rpx;background:transparent;" class="data-v-57280228"></view></scroll-view></view><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="cart-bar data-v-57280228" bindtap="__e"><text class="data-v-57280228">{{"已选 "+$root.g0+" 种 | 共 "+totalCount+" 杯"}}</text><button data-event-opts="{{[['tap',[['submitOrder',['$event']]]]]}}" class="main-btn data-v-57280228" catchtap="__e">提交订单</button></view><block wx:if="{{showCartPopup}}"><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" class="cart-popup-mask data-v-57280228" bindtap="__e"><view class="cart-popup data-v-57280228"><view class="cart-popup-title-row data-v-57280228"><view data-event-opts="{{[['tap',[['e2',['$event']]]]]}}" class="cart-popup-close-abs data-v-57280228" bindtap="__e">×</view><view class="cart-popup-title data-v-57280228">已选商品</view><text data-event-opts="{{[['tap',[['clearCart',['$event']]]]]}}" class="cart-popup-clear data-v-57280228" catchtap="__e">清空</text></view><block wx:if="{{$root.g1===0}}"><view class="cart-popup-empty data-v-57280228">购物车为空</view></block><block wx:else><view class="data-v-57280228"><block wx:for="{{$root.l2}}" wx:for-item="item" wx:for-index="__i1__" wx:key="id"><view class="cart-popup-item data-v-57280228"><image class="cart-popup-img data-v-57280228" src="{{item.$orig.img||item.$orig.image_url||$oss+'logo.png'}}" mode="aspectFill"></image><view class="cart-popup-info data-v-57280228"><view class="cart-popup-name data-v-57280228">{{item.$orig.name}}</view><view class="cart-popup-spec data-v-57280228">{{item.$orig.spec+" / "+item.$orig.sweet+" / "+item.$orig.temp}}<block wx:if="{{item.g2}}"><label class="_span data-v-57280228">{{'/ '+(item.g3?item.g4:item.$orig.toppings)}}</label></block></view><view class="cart-popup-price data-v-57280228">{{"￥"+item.$orig.price+" x "+item.$orig.count}}</view></view><view data-event-opts="{{[['tap',[['deleteCartItem',['$0'],[[['cart','id',item.$orig.id]]]]]]]}}" class="cart-popup-delete data-v-57280228" catchtap="__e">删除</view></view></block></view></block></view></view></block></view>