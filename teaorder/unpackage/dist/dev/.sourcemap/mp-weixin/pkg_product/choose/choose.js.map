{"version":3,"sources":["uni-app:///main.js","webpack:///D:/uniapp_project/food/pkg_product/choose/choose.vue?d772","webpack:///D:/uniapp_project/food/pkg_product/choose/choose.vue?d05a","webpack:///D:/uniapp_project/food/pkg_product/choose/choose.vue?40e8","webpack:///D:/uniapp_project/food/pkg_product/choose/choose.vue?559d","uni-app:///pkg_product/choose/choose.vue","webpack:///D:/uniapp_project/food/pkg_product/choose/choose.vue?fee9","webpack:///D:/uniapp_project/food/pkg_product/choose/choose.vue?ff0c"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","item","specs","sweets","temps","toppings","name","price","selectedSpec","selectedSweet","selectedTemp","selectedToppings","count","onLoad","computed","totalPrice","summary","methods","toggleTopping","idx","changeCount","addToCart","spec","sweet","temp","uni","url","method","user_id","product_id","quantity","sweetness","temperature","success","title","icon","setTimeout","fail","console"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+H;AAC/H;AAC0D;AACL;AACqC;;;AAG1F;AAC6K;AAC7K,gBAAgB,uLAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,6FAAM;AACR,EAAE,sGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,iGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC/CA;AAAA;AAAA;AAAA;AAAqpB,CAAgB,kqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eC2EzqB;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC,WACA;QAAAC;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,EACA;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;EACA;EACAC;IACAC;MAAA;MACA;MACA;QACA;UAAA;QAAA;QACA;MACA;MACA;IACA;IACAC;MACA,8EACA,mCACA;MACA;IACA;EACA;EACAC;IACAC;MACA;MACAC;IACA;IACAC;MACA;MACA;IACA;IACAC;MAAA;QAAA;MACA;QACA;QACA;UACA;YAAA;UAAA;UACA;QACA;QACA;MACA;MACA,+CACA;QACAC;QACAC;QACAC;QACAnB;QACAO;QACAL;QAAA;QACAQ;MAAA,EACA;MACA;MACAU;QACAC;QACAC;QACA3B;UACA4B;UAAA;UACAC;UACAC;UACAR;UACAS;UACAC;UACA3B;UACAE;QACA;;QACA0B;UACA;YACAR;cAAAS;cAAAC;YAAA;YACAC;cAAA;YAAA;UACA;YACAX;cAAAS;cAAAC;YAAA;UACA;QACA;QACAE;UACAC;UACAb;YAAAS;YAAAC;UAAA;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACzKA;AAAA;AAAA;AAAA;AAAo9B,CAAgB,m8BAAG,EAAC,C;;;;;;;;;;;ACAx+B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pkg_product/choose/choose.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pkg_product/choose/choose.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./choose.vue?vue&type=template&id=6895321e&scoped=true&\"\nvar renderjs\nimport script from \"./choose.vue?vue&type=script&lang=js&\"\nexport * from \"./choose.vue?vue&type=script&lang=js&\"\nimport style0 from \"./choose.vue?vue&type=style&index=0&id=6895321e&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6895321e\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pkg_product/choose/choose.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./choose.vue?vue&type=template&id=6895321e&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.toppings, function (topping, __i3__) {\n    var $orig = _vm.__get_orig(topping)\n    var g0 = _vm.selectedToppings.includes(topping.name)\n    return {\n      $orig: $orig,\n      g0: g0,\n    }\n  })\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event, spec) {\n      var _temp = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp2 = _temp.eventParams || _temp[\"event-params\"],\n        spec = _temp2.spec\n      var _temp, _temp2\n      _vm.selectedSpec = spec\n    }\n    _vm.e1 = function ($event, sweet) {\n      var _temp3 = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp4 = _temp3.eventParams || _temp3[\"event-params\"],\n        sweet = _temp4.sweet\n      var _temp3, _temp4\n      _vm.selectedSweet = sweet\n    }\n    _vm.e2 = function ($event, temp) {\n      var _temp5 = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp6 = _temp5.eventParams || _temp5[\"event-params\"],\n        temp = _temp6.temp\n      var _temp5, _temp6\n      _vm.selectedTemp = temp\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./choose.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./choose.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"choose-container\">\n    <!-- 商品大图 -->\n    <view class=\"top-img-wrap\">\n      <image :src=\"item.img || item.image_url || ($oss + 'logo.png')\" class=\"product-img-full\" mode=\"aspectFill\" />\n    </view>\n\n    <!-- 商品信息 -->\n    <view class=\"product-info\">\n      <view class=\"product-name\">{{ item.name || '商品名称' }}</view>\n      <view class=\"product-desc\">{{ item.desc || '暂无描述' }}</view>\n      <view class=\"divider\"></view>\n    </view>\n\n    <!-- 规格 -->\n    <view class=\"option-group\">\n      <view class=\"option-title\">规格</view>\n      <view class=\"option-list\">\n        <view v-for=\"spec in specs\" :key=\"spec\"\n              :class=\"['option-btn', selectedSpec === spec ? 'selected' : '']\"\n              @click=\"selectedSpec = spec\">{{ spec }}</view>\n      </view>\n    </view>\n\n    <!-- 甜度 -->\n    <view class=\"option-group\">\n      <view class=\"option-title\">甜度</view>\n      <view class=\"option-list\">\n        <view v-for=\"sweet in sweets\" :key=\"sweet\"\n              :class=\"['option-btn', selectedSweet === sweet ? 'selected' : '']\"\n              @click=\"selectedSweet = sweet\">{{ sweet }}</view>\n      </view>\n    </view>\n\n    <!-- 温度 -->\n    <view class=\"option-group\">\n      <view class=\"option-title\">温度</view>\n      <view class=\"option-list\">\n        <view v-for=\"temp in temps\" :key=\"temp\"\n              :class=\"['option-btn', selectedTemp === temp ? 'selected' : '']\"\n              @click=\"selectedTemp = temp\">{{ temp }}</view>\n      </view>\n    </view>\n\n    <!-- 小料 -->\n    <view class=\"option-group\">\n      <view class=\"option-title\">添加小料</view>\n      <view class=\"option-list\">\n        <view v-for=\"topping in toppings\" :key=\"topping.name\"\n              :class=\"['option-btn', selectedToppings.includes(topping.name) ? 'selected' : '']\"\n              @click=\"toggleTopping(topping.name)\">\n          {{ topping.name }} (+￥{{ topping.price }})\n        </view>\n      </view>\n    </view>\n\n    <!-- 已选规格描述 -->\n    <view class=\"summary\">{{ summary }}</view>\n\n    <!-- 价格 + 数量 -->\n    <view class=\"price-qty-line\">\n      <text class=\"footer-price\">￥{{ totalPrice }}</text>\n      <view class=\"qty-box\">\n        <button class=\"square-btn\" @click=\"changeCount(-1)\" :disabled=\"count<=1\">-</button>\n        <text class=\"qty-num\">{{ count }}</text>\n        <button class=\"square-btn\" @click=\"changeCount(1)\">+</button>\n      </view>\n    </view>\n\n    <!-- 加入购物车（蓝色按钮） -->\n    <button class=\"add-cart-btn\" @click=\"addToCart\">加入购物车</button>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      item: {},\n      specs: ['大杯', '中杯'],\n      sweets: ['全糖', '七分糖', '五分糖'],\n      temps: ['正常冰', '少冰', '常温', '热'],\n      toppings: [\n        { name: '珍珠', price: 2 },\n        { name: '椰果', price: 2 }\n      ],\n      selectedSpec: '大杯',\n      selectedSweet: '全糖',\n      selectedTemp: '正常冰',\n      selectedToppings: [],\n      count: 1\n    };\n  },\n  onLoad(options) {\n    if (options.item) this.item = JSON.parse(decodeURIComponent(options.item));\n  },\n  computed: {\n    totalPrice() {\n      let base = Number(this.item.price || 0);\n      this.selectedToppings.forEach(name => {\n        const t = this.toppings.find(t => t.name === name);\n        if (t) base += t.price;\n      });\n      return base * this.count;\n    },\n    summary() {\n      const toppingStr = this.selectedToppings.length\n        ? `, 小料：${this.selectedToppings.join('、')}`\n        : '';\n      return `${this.selectedSpec} / ${this.selectedSweet} / ${this.selectedTemp}${toppingStr}`;\n    }\n  },\n  methods: {\n    toggleTopping(name) {\n      const idx = this.selectedToppings.indexOf(name);\n      idx > -1 ? this.selectedToppings.splice(idx, 1) : this.selectedToppings.push(name);\n    },\n    changeCount(delta) {\n      if (this.count + delta < 1) return;\n      this.count += delta;\n    },\n    addToCart() {\n      const singleCupPrice = (() => {\n        let base = Number(this.item.price || 0);\n        this.selectedToppings.forEach(name => {\n          const t = this.toppings.find(t => t.name === name);\n          if (t) base += t.price;\n        });\n        return base;\n      })();\n      const cartItem = {\n        ...this.item,\n        spec: this.selectedSpec,\n        sweet: this.selectedSweet,\n        temp: this.selectedTemp,\n        toppings: this.selectedToppings,\n        count: this.count,\n        price: singleCupPrice, // 单杯含小料价\n        totalPrice: singleCupPrice * this.count\n      };\n      // 调用后端API添加到购物车\n      uni.request({\n        url: 'http://localhost:3000/api/cart',\n        method: 'POST',\n        data: {\n          user_id: uni.getStorageSync('userInfo')?.id, // 登录用户ID\n          product_id: this.item.id,\n          quantity: this.count,\n          spec: this.selectedSpec,\n          sweetness: this.selectedSweet,\n          temperature: this.selectedTemp,\n          toppings: this.selectedToppings,\n          price: singleCupPrice // 单杯含小料价\n        },\n        success: (res) => {\n          if (res.statusCode === 200) {\n      uni.showToast({ title: '已加入购物车', icon: 'success' });\n      setTimeout(() => uni.navigateBack(), 800);\n          } else {\n            uni.showToast({ title: '添加失败', icon: 'none' });\n          }\n        },\n        fail: (error) => {\n          console.error('添加到购物车失败:', error);\n          uni.showToast({ title: '添加失败', icon: 'none' });\n        }\n      });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.choose-container {\n  background: #fff;\n  min-height: 100vh;\n  padding-bottom: 220rpx;\n}\n.top-img-wrap {\n  width: 100vw;\n  line-height: 0;\n}\n.product-img-full {\n  width: 100%;\n  aspect-ratio: 1 / 1;\n  object-fit: cover;\n  display: block;\n}\n.product-info {\n  padding: 32rpx 32rpx 0;\n}\n.product-name {\n  font-size: 42rpx;\n  font-weight: 700;\n  color: #222;\n}\n.product-desc {\n  font-size: 28rpx;\n  color: #666;\n  margin: 12rpx 0 8rpx;\n}\n.divider {\n  height: 2rpx;\n  background: #000;\n  margin: 24rpx 0;\n}\n.option-group {\n  margin: 40rpx 32rpx 0;\n}\n.option-title {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: #222;\n  margin-bottom: 20rpx;\n}\n.option-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20rpx 20rpx; /* 约5mm间距 */\n}\n.option-btn {\n  padding: 8rpx 24rpx;\n  border: 1rpx solid #e5e5e5;\n  border-radius: 0;\n  background: #fff;\n  font-size: 26rpx;\n  color: #333;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: unset;\n  min-height: unset;\n  margin: 0;\n  line-height: 1.2;\n  height: auto;\n  transition: border-color .2s, color .2s, background .2s;\n}\n.option-btn.selected {\n  border-color: #66ccff;\n  background: #fff;\n  color: #333;\n}\n\n.summary {\n  margin: 40rpx 32rpx;\n  font-size: 28rpx;\n  color: #222;\n  font-weight: 500;\n}\n\n/* 价格 + 数量 */\n.price-qty-line {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 32rpx;\n  margin-bottom: 20rpx;\n}\n.footer-price {\n  font-size: 44rpx;\n  font-weight: 700;\n  color: #fa5252;\n}\n.qty-box {\n  display: flex;\n  align-items: center;\n}\n.square-btn {\n  width: 60rpx;\n  height: 60rpx;\n  border-radius: 10rpx;\n  border: 2rpx solid #ffb300;\n  background: #fff;\n  font-size: 36rpx;\n  color: #ffb300;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.qty-num {\n  font-size: 32rpx;\n  color: #222;\n  min-width: 60rpx;\n  text-align: center;\n  margin: 0 16rpx;\n}\n\n/* 蓝色加入购物车按钮 */\n.add-cart-btn {\n  margin: 0 32rpx 40rpx;\n  background: #0099ff;\n  color: #fff;\n  border-radius: 10rpx;\n  font-size: 34rpx;\n  font-weight: 600;\n  height: 88rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0,153,255,.3);\n  border: none;\n}\n.add-cart-btn:active {\n  opacity: 0.85;\n}\n</style>","import mod from \"-!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./choose.vue?vue&type=style&index=0&id=6895321e&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./choose.vue?vue&type=style&index=0&id=6895321e&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1753800639730\n      var cssReload = require(\"D:/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}